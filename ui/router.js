var Montage=require("montage").Montage,Map=require("collections/map").Map,sharedAuthService=require("core/auth-service").shared;exports.Router=Montage.specialize({routes:{value:[]},parts:{value:null},path:{value:null},"default":{value:null},constructor:{value:function(){var e=this;window.onpopstate=function(){e.updatePath()}}},updatePath:{value:function(e){this.path=e||window.location.hash.slice(1),"/landing"==this.path||"/login"==this.path||"/register"==this.path||sharedAuthService.isUserLoggedIn()?"/landing"!=this.path&&"/login"!=this.path&&"/register"!=this.path||!sharedAuthService.isUserLoggedIn()?sharedAuthService.isUserLoggedIn()&&(this.path="/home"):this.path="/home":this.path="/landing",window.location.hash="#"+this.path,this.parts=this.compare(this.path)}},compare:{value:function(e){for(var t=(e.replace(/^#?\//,"")||this["default"]).split("/"),n=0;this.routes.length>n;n++){var i=this.routes[n],o=i.split("/");if(o.length>=t.length){matches=[];for(var a=0;o.length>a;a++){var r=t[a]||"",s=o[a].split(":"),l=RegExp("^"+s[1]+"$").test(r);matches.push([s[0],l?r:!1])}if(matches.every(function(e){return e[1]!==!1}))return Map(matches)}}return Map()}}});